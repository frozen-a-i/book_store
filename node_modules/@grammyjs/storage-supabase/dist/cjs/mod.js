"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.supabaseAdapter = void 0;
function supabaseAdapter({ supabase, table }) {
    if (!supabase) {
        throw new Error('Kindly pass an instance of supabase client to the parameter list.');
    }
    if (!table) {
        throw new Error('Kindly pass a table to the parameter list.');
    }
    return {
        read: async (id) => {
            const { data, error } = await supabase.from(table).select('session').eq('id', id).single();
            if (error || !data) {
                return undefined;
            }
            return JSON.parse(data.session);
        },
        write: async (id, value) => {
            const input = { id, session: JSON.stringify(value) };
            await supabase.from(table).upsert(input, { returning: 'minimal' });
        },
        delete: async (id) => {
            await supabase.from(table).delete({ returning: 'minimal' }).match({ id });
        },
    };
}
exports.supabaseAdapter = supabaseAdapter;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9kLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL21vZC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFPQSxTQUFnQixlQUFlLENBQUksRUFBRSxRQUFRLEVBQUUsS0FBSyxFQUErQztJQUNqRyxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7UUFDZCxNQUFNLElBQUksS0FBSyxDQUFDLG1FQUFtRSxDQUFDLENBQUM7SUFDdkYsQ0FBQztJQUVELElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUNYLE1BQU0sSUFBSSxLQUFLLENBQUMsNENBQTRDLENBQUMsQ0FBQztJQUNoRSxDQUFDO0lBRUQsT0FBTztRQUNMLElBQUksRUFBRSxLQUFLLEVBQUUsRUFBVSxFQUFFLEVBQUU7WUFDekIsTUFBTSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsR0FBRyxNQUFNLFFBQVEsQ0FBQyxJQUFJLENBQVUsS0FBSyxDQUFDLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUM7WUFFcEcsSUFBSSxLQUFLLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQztnQkFDbkIsT0FBTyxTQUFTLENBQUM7WUFDbkIsQ0FBQztZQUVELE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFNLENBQUM7UUFDdkMsQ0FBQztRQUNELEtBQUssRUFBRSxLQUFLLEVBQUUsRUFBVSxFQUFFLEtBQVEsRUFBRSxFQUFFO1lBQ3BDLE1BQU0sS0FBSyxHQUFHLEVBQUUsRUFBRSxFQUFFLE9BQU8sRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUM7WUFFckQsTUFBTSxRQUFRLENBQUMsSUFBSSxDQUFVLEtBQUssQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLENBQUMsQ0FBQztRQUM5RSxDQUFDO1FBQ0QsTUFBTSxFQUFFLEtBQUssRUFBRSxFQUFVLEVBQUUsRUFBRTtZQUMzQixNQUFNLFFBQVEsQ0FBQyxJQUFJLENBQVUsS0FBSyxDQUFDLENBQUMsTUFBTSxDQUFDLEVBQUUsU0FBUyxFQUFFLFNBQVMsRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQztRQUNyRixDQUFDO0tBQ0YsQ0FBQztBQUNKLENBQUM7QUE1QkQsMENBNEJDIn0=